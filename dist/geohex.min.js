"use strict";!function(t,r){if("function"==typeof define&&define.amd)define(["exports"],r);else if("undefined"!=typeof exports)r(exports);else{var n={exports:{}};r(n.exports),t.geohex=n.exports}}(this,function(t){function r(t,r){var n=t*l/180,e=Math.log(Math.tan((90+r)*Math.PI/360))/(Math.PI/180);return e*=l/180,{x:n,y:e}}function n(t,r){var n=t/l*180,e=r/l*180;return e=180/Math.PI*(2*Math.atan(Math.exp(e*Math.PI/180))-Math.PI/2),{lon:n,lat:e}}function e(t){return l/Math.pow(3,t+1)}function a(t,r){return[(t[0]+r[0])/2,(t[1]+r[1])/2]}function o(t,r){var n=h(r[1]-t[1]),e=h(r[0]-t[0]),a=h(t[1]),o=h(r[1]),i=Math.sin(n/2)*Math.sin(n/2)+Math.sin(e/2)*Math.sin(e/2)*Math.cos(a)*Math.cos(o),u=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),c=6373;return c*u}function h(t){return t*Math.PI/180}function i(t,h,i,u,c){var s={code:c,lat:t,lon:h,centroid:[t,h]};return s.getLevel=function(){return this.code.length-2},s.getHexSize=function(){return e(this.getLevel()+2)},s.getInnerRadius=function(){var t=this.getCoords();return 1e3*o(a(t[0],t[1]),a(t[3],t[4]))/2},s.getOuterRadius=function(){var t=this.getCoords();return 1e3*o(t[0],t[3])/2},s.getCoords=function(){var t=this.lat,e=this.lon,a=r(e,t),o=a.x,h=a.y,i=Math.tan(Math.PI*(60/180)),u=this.getHexSize(),c=n(o,h+i*u).lat,s=n(o,h-i*u).lat,l=n(o-2*u,h).lon,f=n(o+2*u,h).lon,M=n(o-1*u,h).lon,g=n(o+1*u,h).lon;return[[l,t],[M,c],[g,c],[f,t],[g,s],[M,s]]},s.getPolygon=function(){var t=s.getCoords();return t.push(t[0]),{type:"Feature",geometry:{type:"Polygon",coordinates:[t]},properties:{code:s.code}}},s.getWKT=function(){var t=s.getCoords();return t.push(t[0]),"POLYGON (("+t.map(function(t){return t.join(" ")}).join(", ")+"))"},s}function u(t,a,o){o+=2;var h=e(o),u=r(a,t),c=u.x,f=u.y,g=6*h,v=6*h*M,d=(c+f/M)/g,p=(f-M*c)/v,y=Math.floor(d),A=Math.floor(p),x=d-y,w=p-A,P=Math.round(d),I=Math.round(p);w>-x+1?2*x>w&&w>.5*x&&(P=y+1,I=A+1):-x+1>w&&w>2*x-1&&.5*x+.5>w&&(P=y,I=A);var b=(M*P*g+I*v)/2,m=(b-I*v)/M,C=n(m,b),O=C.lon,L=C.lat;if(h>l-m){O=180;var j=P;P=I,I=j}for(var S="",q=new Array,z=new Array,B="",H="",R=P,Z=I,F=0;o>=F;F++){var G=Math.pow(3,o-F);R>=Math.ceil(G/2)?(q[F]=2,R-=G):R<=-Math.ceil(G/2)?(q[F]=0,R+=G):q[F]=1,Z>=Math.ceil(G/2)?(z[F]=2,Z-=G):Z<=-Math.ceil(G/2)?(z[F]=0,Z+=G):z[F]=1}for(var F=0;F<q.length;F++)B+=""+q[F]+z[F],H+=parseInt(B,3),S+=H,H="",B="";var K=S.substring(3),N=S.substring(0,3),T=Math.floor(N/30),W=N%30;return S=s.charAt(T)+s.charAt(W)+K,new i(L,O,P,I,S)}function c(t){var r=t.length,a=e(r),o=6*a,h=6*a*M,u=0,c=0,l=""+(30*s.indexOf(t.charAt(0))+s.indexOf(t.charAt(1)))+t.substring(2);l.charAt(0).match(/[15]/)&&l.charAt(1).match(/[^125]/)&&l.charAt(2).match(/[^125]/)&&(5==l.charAt(0)?l="7"+l.substring(1,l.length):1==l.charAt(0)&&(l="3"+l.substring(1,l.length)));for(var f=l.length,v=0;r+1-f>v;v++)l="0"+l,f++;for(var d="",v=0;f>v;v++){var p=parseInt(l.charAt(v)).toString(3);p?1==p.length&&(d+="0"):d+="00",d+=p}for(var y=new Array,A=new Array,v=0;v<d.length/2;v++)y[v]=d.charAt(2*v),A[v]=d.charAt(2*v+1);for(var v=0;r>=v;v++){var x=Math.pow(3,r-v);0==y[v]?u-=x:2==y[v]&&(u+=x),0==A[v]?c-=x:2==A[v]&&(c+=x)}var w=(M*u*o+c*h)/2,P=(w-c*h)/M,I=n(P,w);return I.lon>180+g?(I.lon-=360,u-=Math.pow(3,r),c+=Math.pow(3,r)):I.lon<-(180-g)&&(I.lon+=360,u+=Math.pow(3,r),c-=Math.pow(3,r)),new i(I.lat,I.lon,u,c,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getZoneByLocation=u,t.getZoneByCode=c;var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=20037508.34,f=Math.PI*(30/180),M=Math.tan(f),g=1e-10});